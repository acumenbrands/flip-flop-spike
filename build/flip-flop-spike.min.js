!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){var c=a("./application_settings_adapter"),d=a("./application_document_adapter"),e=function(){function a(a){this.environment=a.environment,this.cookieString=h(this.environment),this.cookieDomain=f(this.environment),this.coupon=g(this.cookieString),this.route=i(this.environment),this.settingsKey=a.settingsKey,this.specialURL=a.specialURL,this.tagMatch=a.tagMatch,this.qualifyingCartValue=a.qualifyingCartValue;var b=this;this.document=new d(b),this.settings=new c(b)}a.prototype.setCoupon=function(a){a&&(this.environment.document.cookie="coupon_code="+a+";path=/;domain="+this.cookieDomain)},a.prototype.routeIsHome=function(){return"/"==this.route},a.prototype.routeIsCart=function(){return"/bag"==this.route},a.prototype.routeIsSpecial=function(){return this.route==this.specialURL},a.prototype.routeIsCatalog=function(){var a=e("conversionType",this.environment);return"Viewed Catalog"==a},a.prototype.routeIsProduct=function(){var a=/^\/products\/[0-9]/i;return a.test(this.route)},a.prototype.cartHasQualifyingProduct=function(){var a=e("behavioralIntent",this.environment);return a&&b(a.line_items,this.tagMatch)?!0:!1},a.prototype.cartHasQualifyingNetTotal=function(){for(var a=e("conversionAttributes",this.environment),b=0;b<a.length;b++)if(a[b].value>=this.qualifyingCartValue)return!0;return!1};var b=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<a[c].tags.length;d++)if(b.test(a[c].tags[d]))return!0;return!1},e=function(a,b){for(var c=0;c<b.dataLayer.length;c++)if(a in b.dataLayer[c])return b.dataLayer[c][a];return null},f=function(a){var b=a.location.hostname.split(".").reverse();return b=b.splice(0,2).reverse(),b.join(".")},g=function(a){var b=/coupon_code=([^\s;]*)/gi,c=b.exec(a)||[null],d=c.reverse()[0];return d},h=function(a){return a.document.cookie},i=function(a){return a.location.pathname};return a}();b.exports=e}).call(this)},{"./application_document_adapter":2,"./application_settings_adapter":3}],2:[function(a,b,c){(function(){var a=function(){function a(a){this.environment=a.environment}return a.prototype.placeNotice=function(a){if("nextElementSelector"in a){var b=this.environment.document.querySelectorAll(a.nextElementSelector)[0];if(b)return b.parentElement.insertBefore(a.noticeElement,b)}else{var c=this.environment.document.querySelectorAll(a.parentElementSelector)[0];if(c)return c.appendChild(a.noticeElement)}},a}();b.exports=a}).call(this)},{}],3:[function(a,b,c){(function(){var c=a("../repositories/storage"),d=function(){function a(a){this.environment=a.environment,this.settingsKey=a.settingsKey;var b={strategy:a.environment.localStorage};this.storage=new c(b)}return a.prototype.isQualified=function(){this.storage.find(this.settingsKey+":qualified")},a.prototype.setQualified=function(){this.storage.save(this.settingsKey+":qualified","true")},a.prototype.unsetQualified=function(){this.storage["delete"](this.settingsKey+":qualified")},a}();b.exports=d}).call(this)},{"../repositories/storage":18}],4:[function(a,b,c){(function(){var c=a("../factories/context"),d=function(){function a(a){this.application=a.application;var b=this,d={type:"cart_has_other_coupon",application:b.application,coupon:a.coupon,strategy:function(){return null!==b.application.coupon&&b.application.coupon!=a.coupon},perform:function(){b.application.settings.unsetQualified()}};return new c(d)}return a}();b.exports=d}).call(this)},{"../factories/context":13}],5:[function(a,b,c){(function(){var c=a("../factories/context"),d=function(){function a(a){this.application=a.application;var b=this,d={type:"cart_qualifies",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsCart()&&b.application.cartHasQualifyingProduct()&&b.application.cartHasQualifyingNetTotal()},perform:function(){b.application.settings.setQualified()}};return new c(d)}return a}();b.exports=d}).call(this)},{"../factories/context":13}],6:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"cart_with_qualifier",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsCart()&&b.application.cartHasQualifyingProduct()},perform:function(){var a={environment:b.application.environment,style:"back",headline:"Get your pair of<br>flip flops Free with<br>$100 purchase",buttonText:"",href:"/footwear"},c={nextElementSelector:"#order_form .cart_summary,#bag_freeshipping",noticeElement:new d(a)};b.application.document.placeNotice(c),b.application.settings.unsetQualified()}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],7:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"cart_without_qualifier",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsCart()&&!b.application.cartHasQualifyingProduct()},perform:function(){var a={environment:b.application.environment,style:"back",headline:'Get a free pair <br class="mobile-only"> of flip flops <br class="desktop-only"> with <br class="mobile-only"> $100 purchase',buttonText:"",href:b.application.specialURL},c={nextElementSelector:"#order_form .cart_summary,#bag_freeshipping",noticeElement:new d(a)};b.application.document.placeNotice(c),b.application.settings.unsetQualified()}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],8:[function(a,b,c){(function(){var c=a("../factories/context"),d=function(){function a(a){var b={type:"default",application:a.application,coupon:a.coupon,strategy:function(){var a=!0;return a},perform:function(){}};return new c(b)}return a}();b.exports=d}).call(this)},{"../factories/context":13}],9:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"views_category",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsCatalog()},perform:function(){var c={environment:b.application.environment,style:"banner",headline:"Get your free pair of flip<br>flops with a $100 purchase",buttonText:"Free flip flops",href:b.application.specialURL},e={nextElementSelector:"#mainWrapper .main_content,#page",noticeElement:new d(c)};b.application.document.placeNotice(e),b.application.settings.unsetQualified(),b.application.setCoupon(a.coupon)}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],10:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"views_home",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsHome()},perform:function(){var c={environment:b.application.environment,headline:"Get your free pair of flip<br>flops with a $100 purchase",buttonText:"Free flip flops",href:b.application.specialURL},e={nextElementSelector:"#mainWrapper .main_content,#page",noticeElement:new d(c)};b.application.document.placeNotice(e),b.application.settings.unsetQualified(),b.application.setCoupon(a.coupon)}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],11:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"views_product",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsProduct()},perform:function(){var c={environment:b.application.environment,style:"small-banner",headline:"Get your free pair of flip<br>flops with a $100 purchase",buttonText:"",href:b.application.specialURL},e={nextElementSelector:"#mainWrapper .main_content,#view",noticeElement:new d(c)};b.application.document.placeNotice(e),b.application.settings.unsetQualified(),b.application.setCoupon(a.coupon)}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],12:[function(a,b,c){(function(){var c=a("../factories/context"),d=a("../factories/notice"),e=function(){function a(a){this.application=a.application;var b=this,e={type:"views_special_category",application:b.application,coupon:a.coupon,strategy:function(){return b.application.routeIsSpecial()},perform:function(){var c={environment:b.application.environment,style:"anchor-banner",headline:"Get your free pair of flip<br>flops with a $100 purchase",buttonText:'Choose Your Free flip flops<span class="desktop-only"><br>on this page</span>',href:"#"},e={nextElementSelector:"#mainWrapper .main_content,#page",noticeElement:new d(c)};b.application.document.placeNotice(e),b.application.settings.unsetQualified(),b.application.setCoupon(a.coupon)}};return new c(e)}return a}();b.exports=e}).call(this)},{"../factories/context":13,"../factories/notice":14}],13:[function(a,b,c){(function(){var a=function(){function a(a){this.type=a.type,this.application=a.application,this.strategy=a.strategy,this.coupon=a.coupon,this.specialURL=a.application.specialURL,this.perform=a.perform||b,this.performed=!1}a.prototype.isApplicable=function(){return this.strategy()},a.prototype.performOnce=function(){this.performed||(this.perform(),this.performed=!0)};var b=function(){};return a}();b.exports=a}).call(this)},{}],14:[function(a,b,c){(function(){var a=function(){function a(a){this.environment=a.environment,this.style=a.style||"",this.headline=a.headline,this.buttonText=a.buttonText,this.href=a.href;var f=b(this),g=c(this),h=d(this),i=e(this);return g.appendChild(h),g.appendChild(i),f.appendChild(g),f}var b=function(a){var b=a.environment.document.createElement("div");return b.className="flip-flop-notice-container "+a.style,b},c=function(a){var b=a.environment.document.createElement("a");return b.className="flip-flop-notice-link",b.href=a.href,b},d=function(a){var b=a.environment.document.createElement("div");return b.innerHTML=a.headline,b.className="flip-flop-notice-headline",b},e=function(a){var b=a.environment.document.createElement("div");return b.innerHTML=a.buttonText,b.className="flip-flop-notice-button",b};return a}();b.exports=a}).call(this)},{}],15:[function(a,b,c){(function(){var c=a("./notifier"),d=a("./adapters/application_adapter"),e=a("./contexts/cart_has_other_coupon"),f=a("./contexts/cart_qualifies"),g=a("./contexts/cart_with_qualifier"),h=a("./contexts/cart_without_qualifier"),i=a("./contexts/views_home"),j=a("./contexts/views_special_category"),k=a("./contexts/views_category"),l=a("./contexts/views_product"),m=a("./contexts/default"),n=function(){function a(a){var e={environment:a.environment,specialURL:a.specialURL,settingsKey:a.settingsKey||"FlipFlopSpike",tagMatch:a.tagMatch||new RegExp("not likely to match anything"),qualifyingCartValue:a.qualifyingCartValue||100},f=new d(e),g={application:f,contexts:b,coupon:a.coupon};return new c(g)}var b=[e,f,g,h,i,j,k,l,m];return a}();b.exports=n}).call(this)},{"./adapters/application_adapter":1,"./contexts/cart_has_other_coupon":4,"./contexts/cart_qualifies":5,"./contexts/cart_with_qualifier":6,"./contexts/cart_without_qualifier":7,"./contexts/default":8,"./contexts/views_category":9,"./contexts/views_home":10,"./contexts/views_product":11,"./contexts/views_special_category":12,"./notifier":17}],16:[function(a,b,c){(function(b){(function(){var c=a("./loader"),d="undefined"!=typeof window?window:b,e=function(){"flipFlopSpike"in d||(d.flipFlopSpike=new c({environment:d,qualifyingCartValue:100,settingsKey:"FlipFlopSpike",coupon:"SPIKECOUPON",specialURL:"/redneck-riviera-collection/sandals",tagMatch:/^redneck\-riviera\-collection/i}))},f=d.document.createElement("link");f.href="http://d3v17ilp3z8t74.cloudfront.net/libs/flip-flop-spike/0.1.0b/css/flip-flop-spike.min.css",f.href="http://assets.countryoutfitter.com.s3.amazonaws.com/libs/flip-flop-spike/0.1.0b/css/flip-flop-spike.min.css",f.media="all",f.rel="stylesheet",f.type="text/css",f.onload=e,d.document.head.appendChild(f)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./loader":15}],17:[function(a,b,c){(function(){var a=function(){function a(a){this.application=a.application,this.coupon=a.coupon||"",this.contexts=a.contexts,this.context=this.getContext(),this.context.performOnce()}a.prototype.getContext=function(){for(var a={application:this.application,specialURL:this.specialURL,coupon:this.coupon},b=0,c=this.contexts.length;c>b;b++){var d=this.contexts[b],e=new d(a);if(e.isApplicable())return e}};return a}();b.exports=a}).call(this)},{}],18:[function(a,b,c){(function(){var a=function(){function a(a){this.strategy=a.strategy}return a.prototype["delete"]=function(a){this.strategy.removeItem(a)},a.prototype.find=function(a){JSON.parse(this.strategy.getItem(a))},a.prototype.save=function(a,b){this.strategy.setItem(a,JSON.stringify(b))},a}();b.exports=a}).call(this)},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]);
//# sourceMappingURL=flip-flop-spike.min.js.map